server:
  port: 8081
spring:
  autoconfigure:
    exclude:
      - org.springframework.ai.model.ollama.autoconfigure.OllamaEmbeddingAutoConfiguration
  application:
    name: chatbot

  # Set max size upload
  servlet:
    multipart:
      enabled: true
      max-file-size: 50MB
      max-request-size: 50MB
      file-size-threshold: 2KB
  datasource:
    url: jdbc:postgresql://localhost:5433/rag_chatbot
    username: postgres
    password: password
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
#  servlet:
#    multipart:
#      max-file-size: 10MB
#      max-request-size: 10MB

  ai:
    model:
      chat: google-genai
    google:
      genai:
        api-key: ${GEMINI_API_KEY}
        chat:
          options:
            model: gemini-2.5-flash
        embedding:
          api-key: ${GEMINI_API_KEY}
          text:
            options:
              models: gemini-embedding-001
    ollama:
      embedding:
        enabled: false
      base-url: http://localhost:11434
      chat:
        model: qwen2.5:3b
    #        chat:
#          model: qwen2.5:3b

  # Fix error upload file - comment this and save data in kb_embeddings table
    # vectorstore:
    #   pgvector:
    #     index-type: HNSW
    #     distance-type: COSINE_DISTANCE
    #     dimensions: 768



jwt:
  signerKey : "4vCM6CA5NXhXhG+LjHY+PfQRZYGjm13cHoNxVPuDyEYz2XB5SO/8Ko2vCxBkqHeT"
  access-token-time : 2000
  refresh-token-time : 10000

# Cohere API Configuration
cohere:
  api:
    key: ${COHERE_API_KEY}  # Set COHERE_API_KEY environment variable
  rerank:
    model: rerank-multilingual-v3.0
    top-n: 5

# Document Metadata Configuration
document:
  metadata:
    # Metadata fields available for documents
    fields:
      - id          # Document unique identifier
      - title       # Document title
      - content     # Document content/text
    # Default metadata structure
    structure:
      id: "string"      # Document ID (UUID or string)
      title: "string"   # Document title
      content: "text"   # Document content/ná»™i dung

# Retrieval Pipeline Configuration
retrieval:
  hybrid-top-k: 50
  rerank-top-k: 30
  final-top-k: 5
  enable-crag: true
  filter:
    enabled: true
    mode: INCLUDE  # INCLUDE or EXCLUDE
    # Filter rules based on metadata fields (id, title, content)
    # Example: Filter by document id or title
    rules: {}  # Example: {id: ["doc-id-1", "doc-id-2"], title: ["Document Title 1"]}

# CRAG Configuration
crag:
  max-depth: 2  # Maximum recursion depth for active retrieval


logging:
  level:
    org.springframework.ai: DEBUG
    org.springframework.web: DEBUG
